---
title: "Лабораторная работа №3. Определение тесноты связи между двумя признаками. Корреляционный и регрессионный анализ"
mainfont: Arial
monofont: Consolas
output:
  pdf_document: 
    latex_engine: lualatex
# Перед верстанием отчёта настоятельно рекомендуется изменить параметры. Более подробная информация по ним представлена в комментариях ниже.
params: 
    surname: "DUBOVSKIJ"
    name: "JAN"
    variant: "19"
    filename: "input.txt"
---

<!-- Ниже расположены два блока с программным кодом, который выводит фамилию и имя студента, а также номер варианта. Они определяются параметрами surname, name и variant, объявленными в преамбуле, расположенной выше. К параметрам в коде можно обращаться через конструкцию params$var, где var - название переменной --> 

<!-- Значения этих параметров можно поменять непосредственно в самом файле или используя опцию "Knit with Parameters..." -->

<!-- Параметр echo=FALSE означает, что в отчёте сам код представлен не будет, будет выведен только результат его выполнения (в данном случае - вывод имени студента и номера варианта) -->

**Студент:**

```{r, echo=FALSE}
cat(params$surname, params$name)
```

**Вариант**

```{r, echo=FALSE}
cat(params$variant)
```

## Чтение данных из файла

<!-- В коде ниже используется переменная params$filename, определённая в преамбуле. Можно её переопределить прямо в этом файле либо сверстать отчёт при помощи команды "Knit with Parameters...", указав в соответствующем поле имя файла или путь к нему. -->

<!-- В зависимости от структуры Вашего файла может понадобиться отредактировать код ниже -->

```{r}
dat <- read.table(file=params$filename, dec=",")
dat
```

## Корреляционное поле

```{r dev=c('png')}
plot(dat,type="p",main="Корреляционное поле",xlab="X", ylab="Y")

```

## Однородность и нормальность распределения факторных признаков

<!-- Проверить на однородность (значение коэффициента вариации) и нормальность распределения факторных признаков. Представить результаты проверки правила «трёх сигм» в табличной форме (смотрите пункт 2 задания) -->

```{r}
sr <- mean(dat[,1])
sigma <- sd(dat[,1])
v<-(sigma/sr)*100
v
rows <- paste0("(", round(sr - (1:3) * sigma, 2), ", ", round(sr + (1:3) * sigma, 2), ")")
tab1 <- rep(0, 3*4)
dim(tab1) <- c(3,4)
tab1<- as.data.frame(tab1)
tab1[,1] = rows
tab1[1,4] = 68.3
tab1[2,4] = 95.4
tab1[3,4] = 99.7
for(i in 1:3){
  counter = 0
  for (variable in dat[,1]) {
    if(sr - i * sigma < variable && sr + i * sigma > variable){
      counter = counter + 1
    }
  }
  tab1[i,2] = counter
  tab1[i,3] = (counter / length(dat[,1])*100)
}
colnames(tab1) = c("Интервалы значений признака фактора",
                   "Число единиц, входящих в интервал",
                   "Удельный вес единиц, входящих в интервал в их общем числе, %",
                   "Удельный вес единиц, входящих в интервал, при нормальном распределении, %")
tab1
```

<!-- Сделайте выводы (напишите их ниже) об однородности и нормальности распределения факторных признаков -->

**Выводы:** ... Поскольку коэффициент вариации <33%, то выборка считается однородной по
исследуемому признаку.При сопоставлении 3 и 4 столбцов получаем наличие нормальности
распределения факторных признаков.

<!-- При наличии аномальных значений среди факторных признаков исключите из исходной выборки все элементы с аномальными значениями признака-фактора. При отсутствии таковых просто удалите программный блок ниже. -->

```{r}

```

## Аналитическая группировка

<!-- Постройте таблицу по примеру, приведённому в пункте 3 задания -->

```{r}
k = 1 + round(log(length(dat[,1]), 2), 0)
h = (max(dat[,1]) - min(dat[,1])) / k
tab2 = rep(0, k*4)
dim(tab2) = c(k,4)
tab2 = as.data.frame(tab2)
rows2 = paste("(", min(dat[,1]) + (1:k) * h - h, ", ", min(dat[,1]) + (1:k) * h, ")", sep = "")
tab2[,1] = rows2
for(i in 1:(k-1)){
  counter = 0
  sm = 0
  for(j in 1:length(dat[,1])){
    if(min(dat[,1]) + (i - 1) * h <= dat[j,1] && min(dat[,1]) + i * h > dat[j,1]){
      counter = counter + 1
      sm = sm + dat[j,2]
    }
  }
  tab2[i,2] = counter
  tab2[i,3] = sm
}
counter = 0
sm = 0
for(variable in dat[,1]){
  if(min(dat[,1]) + (k - 1) * h <= variable && min(dat[,1]) + k * h >= variable){
    counter = counter + 1
    sm = sm + dat[j,2]
  }
}
tab2[k,2] = counter
tab2[k,3] = sm
for (i in 1:k) {
  tab2[i,4] = tab2[i,3] / tab2[i,2]
}
colnames(tab2) = c("Интервалы", 
                     "Число вариант, попавших в i-ый интервал",
                     "Сумма результирующего фактора i-ого интервала",
                     "Средняя величина результирующего фактора в группе")
tab2

```

## Корреляционный анализ

<!-- Расчитать коэффициент корреляции и проверить его значимость при уровне значимости α = 0.01 -->

```{r}
dat[,1] -> x
dat[,2] -> y
cor(x,y)
cor.test(x,y)

```

**Выводы:** ...p-уровень значимости равен 0.04875 > 0,01, а значит нельзя отклонить гипотезу о равенстве коэффициента корреляции нулю. следовательно корреляция не является значимой

## Регрессионный анализ

<!-- Построить модель линейной регрессии для Ваших данных -->

```{r}
x = dat[,1]
y = dat[,2]
lm(y ~ x)

```

<!-- На корреляционном поле изобразить регрессионную прямую -->

```{r dev=c('png')}
plot(dat,type="p",main="Корреляционное поле",xlab="X", ylab="Y")
abline(lm(y ~ x))

```